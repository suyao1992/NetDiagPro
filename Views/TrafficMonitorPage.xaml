<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="NetDiagPro.Views.TrafficMonitorPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    NavigationCacheMode="Enabled"
    Background="Transparent">

    <ScrollViewer Padding="32">
        <StackPanel Spacing="24" MaxWidth="900">
            <!-- Header -->
            <StackPanel Spacing="4">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <FontIcon Glyph="&#xE9F5;" Foreground="{ThemeResource AccentFillColorDefaultBrush}" FontSize="28" />
                    <TextBlock Text="流量监控" Style="{StaticResource TitleTextBlockStyle}" />
                </StackPanel>
                <TextBlock Text="实时监控网络流量和进程使用情况" 
                           Style="{StaticResource BodyTextBlockStyle}" 
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
            </StackPanel>

            <!-- Real-time Speed -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Download -->
                <Border Grid.Column="0" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="20" Margin="0,0,8,0">
                    <StackPanel HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE896;" Foreground="#10B981" FontSize="32" />
                        <TextBlock x:Name="DownloadSpeedText" Text="0.00" 
                                   Style="{StaticResource TitleLargeTextBlockStyle}"
                                   HorizontalAlignment="Center" Margin="0,8,0,0" />
                        <TextBlock Text="Mbps 下载" 
                                   Style="{StaticResource CaptionTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>

                <!-- Upload -->
                <Border Grid.Column="1" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                        CornerRadius="8" Padding="20" Margin="8,0,0,0">
                    <StackPanel HorizontalAlignment="Center">
                        <FontIcon Glyph="&#xE898;" Foreground="#3B82F6" FontSize="32" />
                        <TextBlock x:Name="UploadSpeedText" Text="0.00" 
                                   Style="{StaticResource TitleLargeTextBlockStyle}"
                                   HorizontalAlignment="Center" Margin="0,8,0,0" />
                        <TextBlock Text="Mbps 上传" 
                                   Style="{StaticResource CaptionTextBlockStyle}"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   HorizontalAlignment="Center" />
                    </StackPanel>
                </Border>
            </Grid>

            <!-- Interface Stats -->
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8" Padding="20">
                <StackPanel Spacing="12">
                    <StackPanel Orientation="Horizontal" Spacing="12">
                        <FontIcon Glyph="&#xE839;" Foreground="#F59E0B" FontSize="20" />
                        <TextBlock Text="网络接口统计" Style="{StaticResource SubtitleTextBlockStyle}" />
                    </StackPanel>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="*" />
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0" Grid.Column="0" x:Name="InterfaceNameText" Text="接口: -" />
                        <TextBlock Grid.Row="0" Grid.Column="1" x:Name="InterfaceSpeedText" Text="带宽: -" />
                        <TextBlock Grid.Row="1" Grid.Column="0" x:Name="TotalReceivedText" Text="总接收: -" Margin="0,4,0,0" />
                        <TextBlock Grid.Row="1" Grid.Column="1" x:Name="TotalSentText" Text="总发送: -" Margin="0,4,0,0" />
                        <TextBlock Grid.Row="2" Grid.Column="0" x:Name="PacketsReceivedText" Text="接收包: -" Margin="0,4,0,0" />
                        <TextBlock Grid.Row="2" Grid.Column="1" x:Name="PacketsSentText" Text="发送包: -" Margin="0,4,0,0" />
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Process List -->
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    CornerRadius="8" Padding="20">
                <StackPanel Spacing="12">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="Auto" />
                        </Grid.ColumnDefinitions>
                        <StackPanel Grid.Column="0" Orientation="Horizontal" Spacing="12">
                            <FontIcon Glyph="&#xE71D;" Foreground="#8B5CF6" FontSize="20" />
                            <TextBlock Text="进程网络活动" Style="{StaticResource SubtitleTextBlockStyle}" />
                        </StackPanel>
                        <Button Grid.Column="1" x:Name="RefreshBtn" Click="Refresh_Click" Content="刷新" />
                    </Grid>

                    <!-- Header -->
                    <Grid Padding="8,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*" />
                            <ColumnDefinition Width="100" />
                        </Grid.ColumnDefinitions>
                        <TextBlock Grid.Column="0" Text="进程名称" FontWeight="SemiBold" />
                        <TextBlock Grid.Column="1" Text="连接数" FontWeight="SemiBold" HorizontalAlignment="Right" />
                    </Grid>

                    <ItemsControl x:Name="ProcessList">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <StackPanel Spacing="4" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                    </ItemsControl>

                    <ProgressRing x:Name="LoadingRing" IsActive="False" Width="24" Height="24" />
                </StackPanel>
            </Border>

            <!-- Controls -->
            <StackPanel Orientation="Horizontal" Spacing="12">
                <ToggleButton x:Name="MonitorToggle" Click="MonitorToggle_Click">
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <FontIcon x:Name="MonitorIcon" Glyph="&#xE768;" FontSize="14" />
                        <TextBlock x:Name="MonitorText" Text="开始监控" />
                    </StackPanel>
                </ToggleButton>
                <TextBlock x:Name="LastUpdateText" Text="未开始" VerticalAlignment="Center"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}" />
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
</Page>
